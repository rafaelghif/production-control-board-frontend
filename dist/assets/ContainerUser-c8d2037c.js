import{D as v,X as g,r as o,_ as m,j as e,J as u,M as a,Z as S,$ as h,I as j,Y as _,O as U,T as f,U as C,P as E,Q as L,R as A}from"./index-df07a18a.js";import{C as P}from"./Card-050bf3e7.js";import{u as R}from"./useQuery-a2607d27.js";import{u as y}from"./useToast-6e1913b2.js";import{g as O,u as T}from"./user-service-3b7f6913.js";import{M as k}from"./Modal-128b9747.js";import{u as q}from"./useMutation-cf360b2b.js";const w=()=>{const{setLoading:i}=v(),{errorToast:n}=y();return R({queryKey:["users"],queryFn:()=>O(),onError:async c=>{n(c),i(!1)},onSettled:async()=>{i(!1)},refetchOnWindowFocus:!1,retry:!1})},M=()=>{const i=g(),{setLoading:n}=v(),{successToast:c,errorToast:s}=y();return q({mutationFn:r=>T(r),onMutate:()=>{n(!0)},onError:async r=>{n(!1),s(r)},onSuccess:async r=>{c(r),i.invalidateQueries({queryKey:["users"]})},onSettled:()=>{n(!1)}})},B=o.lazy(()=>m(()=>import("./SelectDepartment-07994963.js"),["assets/SelectDepartment-07994963.js","assets/index-df07a18a.js","assets/index-4515709d.css","assets/useQuery-a2607d27.js","assets/useToast-6e1913b2.js","assets/department-service-381213db.js"])),F=o.lazy(()=>m(()=>import("./SelectLineByDepartment-4b5ff669.js"),["assets/SelectLineByDepartment-4b5ff669.js","assets/index-df07a18a.js","assets/index-4515709d.css","assets/useQuery-a2607d27.js","assets/useToast-6e1913b2.js","assets/line-service-b13602ed.js"])),Q=({isOpen:i,data:n,onDidDismiss:c})=>{const[s,r]=o.useState({}),{mutate:p}=M(),l=(t,d)=>{r(b=>({...b,[t]:d}))},I=t=>{r(d=>({...d,DepartmentId:t})),r(d=>({...d,LineId:""}))},x=t=>{t.preventDefault(),p(s),c()};return o.useEffect(()=>{r(t=>({...t,id:n==null?void 0:n.id,badgeId:n==null?void 0:n.badgeId,password:n==null?void 0:n.password,name:n==null?void 0:n.name,role:n==null?void 0:n.role,inActive:n==null?void 0:n.inActive,DepartmentId:n==null?void 0:n.DepartmentId,LineId:n==null?void 0:n.LineId}))},[n]),e.jsx(k,{title:"Update User",isOpen:i,onDidDismiss:c,children:e.jsxs("form",{onSubmit:x,children:[e.jsx(u,{children:e.jsx(a,{type:"text",label:"Id",labelPlacement:"floating",value:s==null?void 0:s.id,onIonInput:t=>l("id",t.detail.value),disabled:!0,required:!0})}),e.jsx(u,{children:e.jsx(a,{type:"text",label:"Badge Id",labelPlacement:"floating",value:s==null?void 0:s.badgeId,onIonInput:t=>l("badgeId",t.detail.value),required:!0})}),e.jsx(u,{children:e.jsx(a,{type:"password",label:"Password",labelPlacement:"floating",value:s==null?void 0:s.password,onIonInput:t=>l("password",t.detail.value),required:!0})}),e.jsx(u,{children:e.jsx(a,{type:"text",label:"Name",labelPlacement:"floating",value:s==null?void 0:s.name,onIonInput:t=>l("name",t.detail.value),required:!0})}),e.jsx(u,{children:e.jsxs(S,{value:s==null?void 0:s.role,onIonChange:t=>l("role",t.detail.value),children:[e.jsx(h,{value:"Basic",children:"Basic"}),e.jsx(h,{value:"Admin",children:"Admin"}),e.jsx(h,{value:"Super User",children:"Super User"})]})}),e.jsxs(o.Suspense,{fallback:e.jsx(j,{name:"crescent"}),children:[e.jsx(B,{value:s==null?void 0:s.DepartmentId,onChange:t=>I(t)}),s.DepartmentId&&e.jsx(F,{value:s==null?void 0:s.LineId,departmentId:s==null?void 0:s.DepartmentId,onChange:t=>l("LineId",t)})]}),e.jsx(u,{children:e.jsx(_,{checked:s==null?void 0:s.inActive,onIonChange:t=>l("inActive",t.detail.checked),children:"InActive"})}),e.jsx(U,{type:"submit",expand:"block",children:"Submit"})]})})},V=o.lazy(()=>m(()=>import("./TableUser-407aeb0c.js"),["assets/TableUser-407aeb0c.js","assets/index-df07a18a.js","assets/index-4515709d.css","assets/Table-78c0577c.js","assets/date-fns-2da5c2fc.js"])),Y=()=>{const{data:i,isLoading:n,refetch:c}=w(),[s,r]=o.useState(),[p,l]=o.useState(!1),I=t=>{r(t),l(!0)},x=async t=>{c(),t.detail.complete()};return e.jsxs(e.Fragment,{children:[e.jsx(f,{slot:"fixed",onIonRefresh:x,children:e.jsx(C,{})}),e.jsx(E,{children:e.jsx(L,{children:e.jsx(A,{children:e.jsx(P,{title:"Data User",children:n?e.jsx(j,{name:"crescent"}):e.jsx(o.Suspense,{fallback:e.jsx(j,{name:"crescent"}),children:e.jsx(V,{data:i,handleClickBtnEdit:t=>I(t)})})})})})}),e.jsx(Q,{data:s,isOpen:p,onDidDismiss:()=>l(!1)})]})};export{Y as default};
