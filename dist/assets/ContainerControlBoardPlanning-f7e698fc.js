import{D as h,X as j,r as i,j as e,J as m,M as f,O as g,_ as y,G as C,T as b,U as P,P as S,Q as B,R as E,I as x}from"./index-df07a18a.js";import{C as v}from"./Card-050bf3e7.js";import{u as L}from"./useQuery-a2607d27.js";import{u as I}from"./useToast-6e1913b2.js";import{g as M,u as R}from"./control-board-planning-e3c1cc3a.js";import{M as _}from"./Modal-128b9747.js";import{u as T}from"./useMutation-cf360b2b.js";const q=s=>{const{setLoading:n}=h(),{errorToast:a}=I();return L({queryKey:["control-board-planning",{lineId:s||"All"}],queryFn:()=>M(s),onError:async t=>{a(t),n(!1)},onSettled:async()=>{n(!1)},refetchOnWindowFocus:!1,retry:!1})},O=()=>{const s=j(),{setLoading:n}=h(),{successToast:a,errorToast:t}=I();return T({mutationFn:r=>R(r),onMutate:()=>{n(!0)},onError:async r=>{n(!1),t(r)},onSuccess:async r=>{a(r),s.invalidateQueries({queryKey:["control-board-planning"]})},onSettled:()=>{n(!1)}})},U=({isOpen:s,data:n,onDidDismiss:a})=>{const[t,r]=i.useState({}),{mutate:c}=O(),u=(o,p)=>{r(l=>({...l,[o]:p}))},d=o=>{o.preventDefault(),c(t),a()};return i.useEffect(()=>{r(o=>({...o,id:n==null?void 0:n.id,date:n==null?void 0:n.date,LineId:n==null?void 0:n.LineId}))},[n]),e.jsx(_,{title:"Update Control Board Planning",isOpen:s,onDidDismiss:a,children:e.jsxs("form",{onSubmit:d,children:[e.jsx(m,{children:e.jsx(f,{type:"text",label:"Id",labelPlacement:"floating",value:t==null?void 0:t.id,onIonInput:o=>u("id",o.detail.value),required:!0,disabled:!0})}),e.jsx(m,{children:e.jsx(f,{type:"date",label:"Date",labelPlacement:"floating",value:t==null?void 0:t.date,onIonInput:o=>u("date",o.detail.value),required:!0})}),e.jsx(g,{type:"submit",expand:"block",children:"Submit"})]})})},F=i.lazy(()=>y(()=>import("./TableControlBoardPlanning-d8a08f86.js"),["assets/TableControlBoardPlanning-d8a08f86.js","assets/index-df07a18a.js","assets/index-4515709d.css","assets/Table-78c0577c.js","assets/date-fns-2da5c2fc.js","assets/Card-050bf3e7.js","assets/useQuery-a2607d27.js","assets/useToast-6e1913b2.js","assets/control-board-planning-e3c1cc3a.js","assets/Modal-128b9747.js","assets/useMutation-cf360b2b.js"])),K=()=>{const{line:s}=C(),{data:n,isLoading:a,refetch:t}=q(s==null?void 0:s.id),[r,c]=i.useState(),[u,d]=i.useState(!1),o=l=>{c(l),d(!0)},p=async l=>{t(),l.detail.complete()};return e.jsxs(e.Fragment,{children:[e.jsx(b,{slot:"fixed",onIonRefresh:p,children:e.jsx(P,{})}),e.jsx(S,{children:e.jsx(B,{children:e.jsx(E,{children:e.jsx(v,{title:"Data Control Board Planning",children:a?e.jsx(x,{name:"crescent"}):e.jsx(i.Suspense,{fallback:e.jsx(x,{name:"crescent"}),children:e.jsx(F,{data:n,handleClickBtnEdit:l=>o(l)})})})})})}),e.jsx(U,{isOpen:u,data:r,onDidDismiss:()=>d(!1)})]})};export{K as default};
