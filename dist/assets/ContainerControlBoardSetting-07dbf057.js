import{D as y,X as b,r as a,_ as I,F as j,j as e,I as x,J as u,M as m,Y as C,O as T,E as v,T as B,U as P,P as R,Q as k,R as E}from"./index-df07a18a.js";import{C as _}from"./Card-050bf3e7.js";import{u as S}from"./useQuery-a2607d27.js";import{u as f}from"./useToast-6e1913b2.js";import{g as L,u as Q,a as q}from"./control-board-setting-050dfd4e.js";import{M}from"./Modal-128b9747.js";import{u as w}from"./useMutation-cf360b2b.js";const F=r=>{const{setLoading:n}=y(),{errorToast:s}=f();return S({queryKey:["control-board-setting",{departmentId:r}],queryFn:()=>L(r),onError:async i=>{s(i),n(!1)},onSettled:async()=>{n(!1)},refetchOnWindowFocus:!1,retry:!1})},O=()=>{const r=b(),{setLoading:n}=y(),{successToast:s,errorToast:i}=f();return w({mutationFn:t=>Q(t),onMutate:()=>{n(!0)},onError:async t=>{n(!1),i(t)},onSuccess:async t=>{s(t),r.invalidateQueries({queryKey:["control-board-setting"]})},onSettled:()=>{n(!1)}})},U=a.lazy(()=>I(()=>import("./SelectLineByDepartment-4b5ff669.js"),["assets/SelectLineByDepartment-4b5ff669.js","assets/index-df07a18a.js","assets/index-4515709d.css","assets/useQuery-a2607d27.js","assets/useToast-6e1913b2.js","assets/line-service-b13602ed.js"])),W=({isOpen:r,data:n,onDidDismiss:s})=>{const{department:i}=j(),[t,d]=a.useState({}),{mutate:h}=O(),l=(o,g)=>{d(c=>({...c,[o]:g}))},p=o=>{o.preventDefault(),h(t),s()};return a.useEffect(()=>{d(o=>({...o,actualWorkingTime:n==null?void 0:n.actualWorkingTime,planQty:n==null?void 0:n.planQty,manPowerRegular:n==null?void 0:n.manPowerRegular,shiftTotal:n==null?void 0:n.shiftTotal,LineId:n==null?void 0:n.LineId}))},[n]),e.jsx(M,{title:"Update Control Board Setting",isOpen:r,onDidDismiss:s,children:e.jsxs("form",{onSubmit:p,children:[e.jsx(a.Suspense,{fallback:e.jsx(x,{name:"crescent"}),children:e.jsx(U,{value:t==null?void 0:t.LineId,departmentId:i.id,onChange:o=>l("LineId",o)})}),e.jsx(u,{children:e.jsx(m,{type:"number",label:"Actual Working Time",labelPlacement:"floating",value:t==null?void 0:t.actualWorkingTime,onIonInput:o=>l("actualWorkingTime",o.detail.value),required:!0})}),e.jsx(u,{children:e.jsx(m,{type:"number",label:"Plan QTY",labelPlacement:"floating",value:t==null?void 0:t.planQty,onIonInput:o=>l("planQty",o.detail.value),required:!0})}),e.jsx(u,{children:e.jsx(m,{type:"number",label:"Man Power Regular",labelPlacement:"floating",value:t==null?void 0:t.manPowerRegular,onIonInput:o=>l("manPowerRegular",o.detail.value),required:!0})}),e.jsx(u,{children:e.jsx(m,{type:"number",label:"Shift Total",labelPlacement:"floating",value:t==null?void 0:t.shiftTotal,onIonInput:o=>l("shiftTotal",o.detail.value),required:!0})}),e.jsx(u,{children:e.jsx(C,{checked:t==null?void 0:t.inActive,onIonChange:o=>l("inActive",o.detail.checked),children:"InActive"})}),e.jsx(T,{type:"submit",expand:"block",children:"Submit"})]})})},A=()=>{const{setLoading:r}=y(),{errorToast:n}=f();return S({queryKey:["control-board-setting"],queryFn:()=>q(),onError:async s=>{n(s),r(!1)},onSettled:async()=>{r(!1)},refetchOnWindowFocus:!1,retry:!1})},V=a.lazy(()=>I(()=>import("./TableControlBoardSetting-61bc8c44.js"),["assets/TableControlBoardSetting-61bc8c44.js","assets/index-df07a18a.js","assets/index-4515709d.css","assets/Table-78c0577c.js","assets/date-fns-2da5c2fc.js"])),N=()=>{const{department:r}=j(),{user:n}=v(),{data:s,isLoading:i,refetch:t}=n.role!=="Basic"?A():F(r.id),[d,h]=a.useState(),[l,p]=a.useState(!1),o=c=>{h(c),p(!0)},g=async c=>{t(),c.detail.complete()};return e.jsxs(e.Fragment,{children:[e.jsx(B,{slot:"fixed",onIonRefresh:g,children:e.jsx(P,{})}),e.jsx(R,{children:e.jsx(k,{children:e.jsx(E,{children:e.jsx(_,{title:"Data Control Board Setting",children:i?e.jsx(x,{name:"crescent"}):e.jsx(a.Suspense,{fallback:e.jsx(x,{name:"crescent"}),children:e.jsx(V,{data:s,handleClickBtnEdit:c=>o(c)})})})})})}),e.jsx(W,{data:d,isOpen:l,onDidDismiss:()=>p(!1)})]})};export{N as default};
