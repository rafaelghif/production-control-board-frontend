import{D as j,X as v,r as i,j as n,J as x,M as f,Y as g,O as h,_ as T,T as A,U as M,P as E,Q as O,R as I,I as y,aj as R}from"./index-df07a18a.js";import{T as k}from"./Table-78c0577c.js";import{a as q}from"./date-fns-2da5c2fc.js";import{C as D}from"./Card-050bf3e7.js";import{u as U}from"./useQuery-a2607d27.js";import{u as b}from"./useToast-6e1913b2.js";import{a as _,u as w,c as F}from"./line-service-b13602ed.js";import{M as S}from"./Modal-128b9747.js";import{u as C}from"./useMutation-cf360b2b.js";const P=a=>{const{setLoading:e}=j(),{errorToast:o}=b();return U({queryKey:["lines",{departmentId:a}],queryFn:()=>_(a),onError:async t=>{o(t),e(!1)},onSettled:async()=>{e(!1)},refetchOnWindowFocus:!1,retry:!1})},Q=()=>{const a=v(),{setLoading:e}=j(),{successToast:o,errorToast:t}=b();return C({mutationFn:r=>w(r),onMutate:()=>{e(!0)},onError:async r=>{e(!1),t(r)},onSuccess:async r=>{o(r),a.invalidateQueries({queryKey:["lines"]})},onSettled:()=>{e(!1)}})},B=({isOpen:a,data:e,onDidDismiss:o})=>{const[t,r]=i.useState({}),{mutate:d}=Q(),l=(s,u)=>{r(m=>({...m,[s]:u}))},c=s=>{s.preventDefault(),d(t),o()};return i.useEffect(()=>{r(s=>({...s,id:e==null?void 0:e.id,name:e==null?void 0:e.name,inActive:e==null?void 0:e.inActive,DepartmentId:e==null?void 0:e.DepartmentId}))},[e]),n.jsx(S,{title:"Update Line",isOpen:a,onDidDismiss:o,children:n.jsxs("form",{onSubmit:c,children:[n.jsx(x,{children:n.jsx(f,{type:"text",label:"Id",labelPlacement:"floating",value:t==null?void 0:t.id,onIonInput:s=>l("id",s.detail.value),required:!0,disabled:!0})}),n.jsx(x,{children:n.jsx(f,{type:"text",label:"Name",labelPlacement:"floating",value:t==null?void 0:t.name,onIonInput:s=>l("name",s.detail.value),required:!0})}),n.jsx(x,{children:n.jsx(g,{checked:t==null?void 0:t.inActive,onIonChange:s=>l("inActive",s.detail.checked),children:"InActive"})}),n.jsx(h,{type:"submit",expand:"block",children:"Submit"})]})})},N=()=>{const a=v(),{setLoading:e}=j(),{successToast:o,errorToast:t}=b();return C({mutationFn:r=>F(r),onMutate:()=>{e(!0)},onError:async r=>{e(!1),t(r)},onSuccess:async r=>{o(r),a.invalidateQueries({queryKey:["lines"]})},onSettled:()=>{e(!1)}})},z=({isOpen:a,departmentId:e,onDidDismiss:o})=>{const[t,r]=i.useState({name:"",DepartmentId:e}),{mutate:d}=N(),l=(s,u)=>{r(m=>({...m,[s]:u}))},c=s=>{s.preventDefault(),d(t),r({name:"",DepartmentId:e}),o()};return i.useEffect(()=>{r(s=>({...s,DepartmentId:e}))},[e]),n.jsx(S,{title:"Create Line",isOpen:a,onDidDismiss:o,children:n.jsxs("form",{onSubmit:c,children:[n.jsx(x,{children:n.jsx(f,{type:"text",label:"Name",labelPlacement:"floating",value:t.name,onIonInput:s=>l("name",s.detail.value),required:!0})}),n.jsx(h,{type:"submit",expand:"block",children:"Submit"})]})})},K=i.lazy(()=>T(()=>import("./TableLine-a5a47cd6.js"),["assets/TableLine-a5a47cd6.js","assets/index-df07a18a.js","assets/index-4515709d.css","assets/Table-78c0577c.js","assets/date-fns-2da5c2fc.js"])),V=({data:a})=>{const{data:e,isLoading:o,refetch:t}=P(a.id),[r,d]=i.useState(),[l,c]=i.useState(!1),[s,u]=i.useState(!1),m=p=>{d(p),u(!0)},L=async p=>{t(),p.detail.complete()};return n.jsxs(n.Fragment,{children:[n.jsx(A,{slot:"fixed",onIonRefresh:L,children:n.jsx(M,{})}),n.jsx(E,{children:n.jsxs(O,{children:[n.jsx(I,{size:"12",children:n.jsx(h,{onClick:()=>c(!0),fill:"clear",className:"float-right",children:"Create Line"})}),n.jsx(I,{size:"12",children:n.jsx(D,{title:`Data Line ${a.name}`,children:o?n.jsx(y,{name:"crescent"}):n.jsx(i.Suspense,{fallback:n.jsx(y,{name:"crescent"}),children:n.jsx(K,{data:e,handleClickBtnEdit:p=>m(p)})})})})]})}),n.jsx(z,{departmentId:a.id,isOpen:l,onDidDismiss:()=>c(!1)}),n.jsx(B,{data:r,isOpen:s,onDidDismiss:()=>u(!1)})]})},te=({data:a=[],handleClickBtnEdit:e})=>{const o=i.useMemo(()=>[{name:"Name",selector:t=>t.name,sortable:!0,wrap:!0},{name:"Abbreviation",selector:t=>t.abbreviation,sortable:!0,wrap:!0},{name:"Status",cell:t=>n.jsx(R,{color:t.inActive?"danger":"success",children:t.inActive?"InActive":"Active"}),sortable:!0},{name:"Update By",selector:t=>t.updatedBy,sortable:!0},{name:"Update At",selector:t=>q(t.updatedAt),sortable:!0,wrap:!0},{name:"Edit",cell:t=>n.jsx(h,{fill:"clear",color:"warning",onClick:()=>{e(t)},children:"Edit"}),center:!0}],[e]);return n.jsx(k,{columns:o,data:a,responsive:!0,pagination:!0,striped:!0,highlightOnHover:!0,expandableRows:!0,expandableRowsComponent:V})};export{te as default};
